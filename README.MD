# ğŸ“ Secondary School LMS (Spring Boot)

A **Learning Management System (LMS)** built with **Spring Boot**, designed for **secondary school students**.
It allows teachers to manage lessons, quizzes, discussions, and subjects while students can register for subjects, attempt quizzes, and participate in discussions.
Includes a **role & permission system** similar to **Laravel Spatie** for fine-grained access control.

---

## ğŸš€ Features

* ğŸ‘©â€ğŸ« **User Roles & Permissions** (Student, Teacher, Admin + fine-grained permissions)
* ğŸ“š **Subjects & Lessons** (video, PDF, quizzes)
* ğŸ“ **Quizzes & Attempts** (with scoring and tracking by academic year)
* ğŸ’¬ **Discussions** (tied to subjects & academic years)
* ğŸ“… **Academic Year Tracking** (all content and interactions scoped per year)
* ğŸ”’ **Secure Authentication & Authorization** with Spring Security
* ğŸ› ï¸ **RESTful API** (strict MVC separation, backend-only)

---

## ğŸ› ï¸ Tech Stack

* **Backend:** Spring Boot 3+, Spring Security, Spring Data JPA, Hibernate
* **Database:** MySQL 8+
* **Auth:** JWT (JSON Web Tokens)
* **Build Tool:** Maven or Gradle (depending on setup)
* **Other:** Lombok, HikariCP, Flyway (for DB migrations, optional)

---

## ğŸ“‚ Project Structure (Package-by-Layer)

```
src/main/java/com/example/lms
â”‚â”€â”€ config/          # Security, JWT, Web configs
â”‚â”€â”€ controllers/     # REST Controllers
â”‚â”€â”€ dto/             # Data Transfer Objects
â”‚â”€â”€ entities/        # JPA Entities (with Lombok)
â”‚â”€â”€ repositories/    # Spring Data Repositories
â”‚â”€â”€ services/        # Business Logic Services
â”‚â”€â”€ exceptions/      # Custom Exception Handlers
â”‚â”€â”€ utils/           # Helper classes
```

---

## ğŸ—„ï¸ Database Design

See full design ğŸ‘‰ [db.md](./db.md)

Main Entities:

* Users, Roles, Permissions, UserRoles, RolePermissions, UserPermissions
* AcademicYears, Subjects, StudentSubjects
* LessonComponents, CourseContents
* Quizzes, QuizQuestions, QuizOptions, QuizAttempts, QuizResponses
* Discussions, DiscussionPosts

---

## âš¡ Getting Started

### Prerequisites

* Java 21+ (recommend latest LTS)
* MySQL 8+
* Maven or Gradle
* VS Code (with Spring Boot & Java extensions)

### Setup

1. **Clone Repository**

   ```bash
   git clone https://github.com/yourusername/lms.git
   cd lms
   ```

2. **Configure Database**
   Create a MySQL database:

   ```sql
   CREATE DATABASE lms_db;
   ```

   Update `application.properties` or `application.yml`:

   ```properties
   spring.datasource.url=jdbc:mysql://localhost:3306/lms_db
   spring.datasource.username=root
   spring.datasource.password=yourpassword

   spring.jpa.hibernate.ddl-auto=update
   spring.jpa.show-sql=true
   ```

3. **Run Application**

   ```bash
   ./mvnw spring-boot:run
   ```

   The app runs on ğŸ‘‰ [http://localhost:8080](http://localhost:8080)

---

## ğŸ” Authentication & Authorization

* **JWT-based authentication**
* **Role & Permission checks** with:

  ```java
  @PreAuthorize("hasRole('TEACHER')")
  @PreAuthorize("hasAuthority('upload_lesson')")
  ```
* Frontend can use the `/me` endpoint to get user roles & permissions and hide/show UI accordingly.

---

## ğŸ§ª Testing

### Running Tests

```bash
# Run all tests
./mvnw test

# Run specific test classes
./mvnw test -Dtest="**/*EntityTest"

# Run tests with verbose output
./mvnw test -Dtest="AcademicYearEntityTest"
```

### Test Coverage

This project includes comprehensive test coverage using **JaCoCo**:

```bash
# Basic coverage report
./run-coverage.sh basic

# Coverage with quality gates
./run-coverage.sh check

# Entity tests only with coverage
./run-coverage.sh entity

# Open HTML coverage report
./run-coverage.sh report
```

**Coverage Report Location:** `target/site/jacoco/index.html`

**Current Test Status:**
- âœ… **Entity Layer**: 12 test classes with 77+ tests
- âš ï¸ **Service Layer**: Needs expansion
- âš ï¸ **Controller Layer**: Needs expansion
- âš ï¸ **Repository Layer**: Needs expansion

For detailed coverage instructions, see: [COVERAGE.md](./COVERAGE.md)

### Test Structure

```
src/test/java/com/mphoola/e_empuzitsi/
â”‚â”€â”€ entity/              # Entity JPA tests (âœ… Complete)
â”‚   â”‚â”€â”€ AcademicYearEntityTest.java
â”‚   â”‚â”€â”€ UserEntityTest.java
â”‚   â”‚â”€â”€ SubjectEntityTest.java
â”‚   â”‚â”€â”€ QuizEntityTest.java
â”‚   â”‚â”€â”€ PermissionEntityTest.java
â”‚   â”‚â”€â”€ RoleEntityTest.java
â”‚   â”‚â”€â”€ ... (12 total entity tests)
â”‚â”€â”€ service/             # Service layer tests (ğŸš§ TODO)
â”‚â”€â”€ controller/          # Controller tests (ğŸš§ TODO)
â”‚â”€â”€ repository/          # Repository tests (ğŸš§ TODO)
```

---

## ğŸ“Œ Roadmap

* [ ] Subject registration APIs
* [ ] Quiz engine with randomization
* [ ] Teacher dashboards
* [ ] Student progress reports
* [ ] REST API documentation (Swagger/OpenAPI)

---

## ğŸ¤ Contributing

1. Fork the project
2. Create your feature branch (`git checkout -b feature/awesome-feature`)
3. Commit your changes (`git commit -m 'Add new feature'`)
4. Push to the branch (`git push origin feature/awesome-feature`)
5. Open a Pull Request

---

## ğŸ“œ License

This project is licensed under the **MIT License** â€“ see the [LICENSE](./LICENSE) file for details.
